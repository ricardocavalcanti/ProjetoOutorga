<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:p="http://primefaces.org/ui">
<h:head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<title>Venda - Listagem</title>
</h:head>
<h:body>
	<p:growl id="mensagem" />

	<h:form id="formulario">
		<p:panel header="Adicione as Unidades de Análise">
			<p:dataTable id="tabelaProduto"
				emptyMessage="Nenhum registro encontrado." paginator="true"
				value="#{itemDeVendaBean.listaUa}" var="listaUas" rows="3">
				<!-- rows: Informa a paginação -->

				<p:column headerText="UA" sortBy="#{listaUas.numeroUa}"
					filterBy="#{listaUas.numeroUa}">
					<!-- sortBy: Ordenação dos dados -->
					<h:outputText value="#{listaUas.numeroUa}" />
					<!-- filterBy: Filtar dados      -->
				</p:column>

				<p:column headerText="Ano">
					<h:outputText value="#{listaUas.ano}" />
				</p:column>

				<p:column headerText="Jan">
					<h:outputText value="#{listaUas.jan}">
						<!-- convertNumber serve para mudar para o padrão BR a emprego de virgula no padrão númerico -->
						<f:convertNumber locale="pt_BR" minFractionDigits="2" />
					</h:outputText>
				</p:column>

				<p:column headerText="Fev">
					<h:outputText value="#{listaUas.fev}">
						<!-- convertNumber serve para mudar para o padrão BR a emprego de virgula no padrão númerico -->
						<f:convertNumber locale="pt_BR" minFractionDigits="2" />
					</h:outputText>
				</p:column>

				<p:column headerText="Mar">
					<h:outputText value="#{listaUas.mar}">
						<f:convertNumber locale="pt_BR" minFractionDigits="2" />
					</h:outputText>
				</p:column>

				<p:column headerText="Abr">
					<h:outputText value="#{listaUas.abr}">
						<f:convertNumber locale="pt_BR" minFractionDigits="2" />
					</h:outputText>
				</p:column>

				<p:column headerText="Mai">
					<h:outputText value="#{listaUas.mai}">
						<f:convertNumber locale="pt_BR" minFractionDigits="2" />
					</h:outputText>
				</p:column>

				<p:column headerText="Jun">
					<h:outputText value="#{listaUas.jun}">
						<f:convertNumber locale="pt_BR" minFractionDigits="2" />
					</h:outputText>
				</p:column>

				<p:column headerText="Jul">
					<h:outputText value="#{listaUas.jul}">
						<f:convertNumber locale="pt_BR" minFractionDigits="2" />
					</h:outputText>
				</p:column>

				<p:column headerText="Ago">
					<h:outputText value="#{listaUas.ago}">
						<f:convertNumber locale="pt_BR" minFractionDigits="2" />
					</h:outputText>
				</p:column>

				<p:column headerText="Set">
					<h:outputText value="#{listaUas.set}">
						<f:convertNumber locale="pt_BR" minFractionDigits="2" />
					</h:outputText>
				</p:column>

				<p:column headerText="Out">
					<h:outputText value="#{listaUas.out}">
						<f:convertNumber locale="pt_BR" minFractionDigits="2" />
					</h:outputText>
				</p:column>

				<p:column headerText="Nov">
					<h:outputText value="#{listaUas.nov}">
						<f:convertNumber locale="pt_BR" minFractionDigits="2" />
					</h:outputText>
				</p:column>

				<p:column headerText="Dez">
					<h:outputText value="#{listaUas.dez}">
						<f:convertNumber locale="pt_BR" minFractionDigits="2" />
					</h:outputText>
				</p:column>

				<p:column headerText="Opções">
					<p:commandButton icon="ui-icon-plus" oncomplete="PF('dialogo').show()"
						actionListener="#{itemDeVendaBean.editar}"
						update=":mensagem :formCalculo:painel">
						<f:attribute name="uaSelecionada" value="#{listaUas}" />
					</p:commandButton>
				</p:column>

			</p:dataTable>
		</p:panel>

		<p:panel header="Garantia da Vazão">
			<p:dataTable id="tabelaCesta" emptyMessage="Nenhum registro encontrado." paginator="true"	
			value="#{itemDeVendaBean.listaItensVenda}" var="listaItensVenda" rows="3">

				<p:column headerText="Unidade de Análise">
					<h:outputText value="#{itensVendas.numeroUa.numeroUa}" />
				</p:column>
				
				<p:column headerText="Ano">
					<h:outputText value="#{itensVendas.numeroUa.numeroUa}" />
				</p:column>

				<p:column headerText="Demanda Pontual">
					<h:outputText value="#{itensVendas.demandaPontual}">
					<f:convertNumber locale="pt_BR" minFractionDigits="2" maxFractionDigits="2"/>
					</h:outputText>
				</p:column>

				<p:column headerText="Garantia da Vazão">
					<h:outputText value="#{itensVendas.garantiaVazao}">					
					<f:convertNumber type="percent"/>
					</h:outputText>
				</p:column>
				
				<p:column headerText="Opções">
					<p:commandButton icon="ui-icon-plus" />
				</p:column>

			</p:dataTable>
		</p:panel>

		<p:panel header="Ua Outorgada">
		</p:panel>
	</h:form>

	<!-- Dialogo calculo de vazão -->
	<p:dialog header="Calculo do Percentual da Vazão" widgetVar="dialogo"
		draggable="false" resizable="false" modal="true" closable="false">
		<h:form id="formCalculo">

			<h:panelGrid id="painel" columns="1">

				<p:outputLabel for="ua" value="Unidade de Análise" />
				<p:inputText id="ua" maxlength="10" size="15"
					value="#{itemDeVendaBean.ua.numeroUa}" />

				<p:outputLabel for="demanda" value="Demanda pontual" />
				<p:inputText id="demanda" label="Demanda" maxlength="10" size="15" value="#{itemDeVendaBean.valor}">					
					<f:convertNumber locale="pt_BR" minFractionDigits="2" />
				</p:inputText>
				<p:outputLabel for="garantia" value="Garantia de vazão" />
				<p:inputText id="garantia" label="Garantia" maxlength="10" size="15"
					value="#{itemDeVendaBean.resultado}">
						<f:convertNumber type="percent"/>
				</p:inputText>
			</h:panelGrid>

			<h:panelGrid columns="4">
				<!--  ///Dar update.	-->
				<p:commandButton value="Calcular" actionListener="#{itemDeVendaBean.calcular}"
					update=":formCalculo:painel" />
				<p:commandButton value="Adicionar" actionListener="#{itemDeVendaBean.adicionar}" 
				update=":formCalculo:painel :formulario:tabelaCesta" oncomplete="PF('dialogo').hide()" >
				<f:attribute name="itemSelecionado" value="#{itensVendas}" />    	
				</p:commandButton>	                                                             	
				<p:commandButton value="Fechar" oncomplete="PF('dialogo').hide()" />
			</h:panelGrid>

		</h:form>
	</p:dialog>
</h:body>
</html>